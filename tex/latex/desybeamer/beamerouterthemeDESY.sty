% Latex-Beamer Template DESY
% version 1.0
% based upon beamer theme for Juelich by i.kabadshow@fz-juelich.de


% % Clear Background
\defbeamertemplate*{background}{DESY}{}
\defbeamertemplate*{background canvas}{DESY}{}
% Nav Symbols
\defbeamertemplate*{navigation symbols}{DESY}{}

% Headline and footline
\defbeamertemplate*{headline}{DESY}{}

% % Sidebar
\defbeamertemplate*{sidebar left}{DESY}{}

% % DESY style requires the logo to be in line with the footer. Set it
% % there to avoid overlapping
\defbeamertemplate*{sidebar right}{DESY}{}
\defbeamertemplate*{sidebar canvas left}{DESY}{}
\defbeamertemplate*{sidebar canvas right}{DESY}{}

% Frame title: DESY
\defbeamertemplate*{frametitle}{DESY}{
	\ifbeamercolorempty[bg]{frametitle}{}{\nointerlineskip}%
	\@tempdima=\textwidth%
	\advance\@tempdima by\beamer@leftmargin%
	\advance\@tempdima by\beamer@rightmargin%
	\begin{beamercolorbox}[sep=0.55cm,wd=\the\@tempdima]{frametitle}
		\if@tempswa\else\csname beamer@fte\endcsname\fi%
		\strut{\usebeamerfont{frametitle}\insertframetitle}\strut\par%
		{%
			\ifx\insertframe\@empty%
				\else%
				{\usebeamerfont{framesubtitle}\usebeamercolor[fg]{framesubtitle}\insertframesubtitle\strut\par}%
			\fi
		}%
		\vskip-3ex%
		\if@tempswa\else\vskip-.3cm\fi% set inside beamercolorbox... evil here...
	\end{beamercolorbox}%
}

\defbeamertemplate*{footline}{DESY}{
	\ifbeamercolorempty[bg]{frametitle}{}{\nointerlineskip}%
	\@tempdima=\textwidth%
	\advance\@tempdima by\beamer@leftmargin%
	\advance\@tempdima by\beamer@rightmargin%
	\begin{beamercolorbox}[sep=0.35cm,wd=\the\@tempdima,ht=2.25ex,dp=0ex,center]{section in head/foot}%
		\begin{beamercolorbox}[leftskip=5mm,ht=3.5mm,dp=0.0mm]{header}
			\usebeamercolor[fg]{date in head/foot}%
			{\usebeamerfont{title in head/foot}%
				\raisebox{-4.8px}{\includegraphics[height=4ex]{img/DESY_Word}}
				\hspace*{0.3em}|\hspace*{0.5em}%
				\usebeamercolor[fg]{title in head/foot}%
				\inserttitle%
				% \usebeamercolor[fg]{author in head/foot}%
				\ifdef{\COLLABORATION}{
					\hspace*{0.3em}|\hspace*{0.5em}%
					\COLLABORATION%
				}{
					\hspace*{0.3em}|\hspace*{0.5em}%
					\insertshortauthor%
				}
				\ifdef{\WORKSHOP}{
					\hspace*{0.3em}|\hspace*{0.5em}%
					\WORKSHOP%
				}{}
				\hspace*{0.3em}|\hspace*{0.5em}%
				\usebeamercolor[fg]{date in head/foot}%
				\insertdate
				\hfill{}
				\usebeamercolor[fg]{page in head/foot}%
				\textbf{\insertframenumber{}/\insertmainframenumber}%
				\hspace*{.5cm}%
			}%
			\ifbeamertemplateempty{footer element1}{}{%
				\usebeamertemplate*{footer element1}%
				\hfill%
			}%
		\end{beamercolorbox}%
	\end{beamercolorbox}%
}

% Part page: DESY
\defbeamertemplate*{part page}{DESY}{
	\@tempdima=\textwidth%
	\advance\@tempdima by\beamer@leftmargin%
	\advance\@tempdima by\beamer@rightmargin%
	\vskip-20pt%
	% For parts: use chapter style, ie. do not repeat the talk title
	% % Do NOT add the DESY dot: it is not round in Liberation Sans
	% \begin{beamercolorbox}[sep=0.55cm,wd=\the\@tempdima]{title}
	%     \usebeamerfont{title}\inserttitle\par%
	% \end{beamercolorbox}%
	\ifx\insertsubtitle\@empty%
	\else%
	\begin{beamercolorbox}[sep=0.54cm,left,wd=\the\@tempdima]{subtitle}
		{\usebeamerfont{title}\usebeamercolor[fg]{title}\insertpart\par}%
	\end{beamercolorbox}
	\vskip1cm
}

%%% Title page: DESY
% Clear Background
\defbeamertemplate*{background}{DESYTitle}{}
\defbeamertemplate*{background canvas}{DESYTitle}{}
\defbeamertemplate*{sidebar canvas left}{DESYTitle}{}

\defbeamertemplate*{title page}{DESY}{
	\@tempdima=\textwidth%
	\advance\@tempdima by\beamer@leftmargin%
	\advance\@tempdima by\beamer@rightmargin%
	\vskip-20pt%
	% Do NOT add the DESY dot: it is not round in Liberation Sans
	\begin{beamercolorbox}[sep=0.53cm,wd=\the\@tempdima]{title}
		\usebeamerfont{title}\inserttitle%\par%
	\end{beamercolorbox}%

	\ifdef{\SUBTITLE}{
		\begin{beamercolorbox}[sep=0.55cm,left,wd=\the\@tempdima]{subtitle}
			%{
			\usebeamerfont{subtitle}\insertsubtitle\par
			%}%
		\end{beamercolorbox}
	}{\vspace{20pt}}

	% \begin{beamercolorbox}[sep=0.55cm,wd=\the\@tempdima,left]{author}
	% Set the box width to only 50% of the text width. This avoids
	% covering the logo for very long headlines, but requires
	% explicit unindentation.
	\vspace{-.7cm}
	\hspace{0.6\textwidth}\tikzmark{rightancor}\break
	\begin{beamercolorbox}[sep=0.55cm,wd=0.55\textwidth,left]{author}
		\tikzmark{topancor}
		{\usebeamerfont{author}\usebeamercolor[fg]{author}\hspace{-.7ex}\insertauthor\iftoggle{forcollab}{\xspace for the \COLLABORATION \xspace Collaboration}{}}
		\tikzmark{bottomancor}
		\vspace{3ex}
		\break
		{\usebeamerfont{author}\usebeamercolor[fg]{normal text}\ifdef{\WORKSHOP}{\WORKSHOP,\xspace}{}\insertdate}%
	\end{beamercolorbox}%
	\begin{tikzpicture}[overlay, remember picture]
		\node[anchor=base] (a) at (pic cs:topancor) {\vphantom{h}}; % push the mark to the top of the line (ie including ascenders)
		\node[anchor=base] (b) at (pic cs:bottomancor) {\vphantom{g}}; % push the mark to the bottom of the line (ie including descenders)
		\iftoggle{colbracket}{
			\draw [decoration={brace,amplitude=0.5em},decorate,ultra thick,gray]
			(a.north -| {pic cs:rightancor}) -- (b.south -| {pic cs:rightancor}) node [pos=0.5, anchor=west, align=left, color=black, xshift=.5em] {\Large\usebeamercolor[fg]{framesubtitle} \COLLABORATION};
		}{}
		\iftoggle{logocms}{
			\node[anchor=north west] at (a.north -| {pic cs:rightancor})
			%  {l};
			{\includegraphics[width=.35\textheight,height=.35\textheight, keepaspectratio]{img/logos/cms.png}};
		}{}
		%  text width=2.8cm,
	\end{tikzpicture}
}

\defbeamertemplate*{footline}{DESYTitle}{
	\vspace{-2cm}
	\makebox[\paperwidth]{
		\hspace{1.5em}
		\iftoggle{logodegesim}{
			\begin{tikzpicture}
				\node[anchor=south west] at (0,0) (img) {\includegraphics[keepaspectratio,width=2.2cm,height=1.3cm]{img/logos/helmholtzai.pdf}};
				\iftoggle{logodegesimnames}{
				\node[anchor=south west] at (0,1.24) {\fontsize{6pt}{6pt}\selectfont \color{helmholtzblue} \textbf{The DeGeSim Project}};
				\node[anchor=south west,text width=3cm] at (0,.8) {\fontsize{5pt}{6pt}\selectfont \color{helmholtzblue} MS, SB, K.\nobreakspace Borras, W.\nobreakspace Fedorko, J.\nobreakspace Jitsev, J.\nobreakspace Katzy and DK};
				}{
				\node[anchor=south west] at (0,.8) {\fontsize{6.5pt}{6.5pt}\selectfont \color{helmholtzblue} \textbf{The DeGeSim Project}};
				}

			\end{tikzpicture}
		}
		\hfill
		\hfill

		% \hspace{.3em}
		\iftoggle{logouh}{
			\includegraphics[keepaspectratio,width=2cm,height=1.3cm]{img/logos/uuh.pdf}%
			\hfill
		}{}

		\iftoggle{logorwth}{
			\includegraphics[keepaspectratio,width=2cm,height=1.3cm]{img/logos/rwth.pdf}%
			\hfill
		}{}

		\iftoggle{logojsc}{
			\includegraphics[keepaspectratio,width=2.7cm,height=1.3cm]{img/logos/jsc.png}%
			\hfill
		}{}

		\iftoggle{logotrimf}{
			\includegraphics[keepaspectratio,width=2cm,height=1.3cm]{img/logos/trimf.jpg}%
			\hfill
		}{}

		\iftoggle{logodesy}{
			\includegraphics[keepaspectratio,width=2cm,height=1.3cm]{img/DESY_Logo}%
		}{}

		\hspace{1.5em}
	}
	\vspace{1em}
}




\newcommand{\resetbeamertemplate}{
	% Set all Parts to the desy style in the beginning
	\setbeamertemplate{footline}[DESY]
	\setbeamertemplate{navigation symbols}[DESY]
	\setbeamertemplate{sidebar right}[DESY]
	\setbeamertemplate{sidebar left}[DESY]
	\setbeamertemplate{sidebar canvas left}[DESY]
	\setbeamertemplate{background canvas}[DESY]
}


% Title slide
\def\maketitle{%
	\setbeamertemplate{background canvas}[DESYTitle]
	\setbeamertemplate{sidebar canvas left}[DESYTitle]
	\setbeamertemplate{logos}[DESYTitle]
	\setbeamertemplate{footline}{}
	\setbeamertemplate{footline}[DESYTitle]
	\begin{frame}[t]
		\vskip-\headheight%
		\vbox{}%
		\titlepage%
		\vfill%
	\end{frame}
	% reset to default
	\resetbeamertemplate
}

% Part slide
\def\makepart{%
	\setbeamertemplate{background canvas}[DESYTitle]
	\setbeamertemplate{sidebar canvas left}[DESYTitle]
	\setbeamertemplate{sidebar right}[DESYTitle]
	\setbeamertemplate{footline}{}
	\begin{frame}[t]
		\vskip-\headheight%
		\vbox{}%
		\partpage%
	\end{frame}
	\resetbeamertemplate
}


\newcommand{\thankyou}{%
	% Thank you page is assembled from metadata.tex
	\begin{frame}
		\frametitle{Thank you!}
		\vfill{}
		\vspace*{3.5cm}
		\fontsize{8}{9}\selectfont
		\begin{columns}
			\begin{column}{.49\textwidth}
				% \textbf{Contact}\\
				\hspace*{-0.4mm}\DESYWord{}Deutsches \\
				Elektronen-Synchrotron\\
				www.desy.de\\
			\end{column}
			\begin{column}{.49\textwidth}
				% \hspace*{0.5cm} \\
				% \ifdef{\COLLABORATION}{{\Large\usebeamercolor[fg]{framesubtitle} \COLLABORATION}\vspace{3ex}\break}{}
				\AUTHOR         \\
				\GROUP          \\
				\MailTo{\EMAIL}
			\end{column}
		\end{columns}
	\end{frame}
}

\resetbeamertemplate

\mode
<all>
